<view class="container"><view class="header"><view class="status-bar"></view><view class="nav-bar"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-btn" bindtap="__e"><text class="iconfont icon-back">←</text></view><text class="header-title">骨关节炎MRI诊断</text><view class="placeholder"></view></view></view><view class="diagnosis-types"><block wx:for="{{diagnosisTypes}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectType',[index]]]]]}}" class="{{['type-item',(currentType===index)?'active':'']}}" bindtap="__e"><text>{{item.name}}</text></view></block></view><block wx:if="{{!imageUrl&&!diagnosisResult}}"><view class="upload-area"><view class="upload-hint"><view class="upload-icon"><text class="iconfont icon-image"></text></view><text class="hint-text">上传膝关节MRI图像</text><text class="sub-hint">请上传清晰的膝关节核磁共振图像，以便系统准确判断骨关节炎分期</text></view><view class="upload-buttons"><view data-event-opts="{{[['tap',[['selectImage',['$event']]]]]}}" class="btn select-image" bindtap="__e"><text class="btn-icon iconfont icon-album"></text><text class="btn-text">选择MRI图像</text></view></view></view></block><block wx:if="{{imageUrl&&!diagnosisResult}}"><view class="preview-area"><image class="preview-image" src="{{imageUrl}}" mode="aspectFill"></image><view class="preview-actions"><view data-event-opts="{{[['tap',[['cancelImage',['$event']]]]]}}" class="action-btn cancel" bindtap="__e">重新选择</view><view data-event-opts="{{[['tap',[['startDiagnosis',['$event']]]]]}}" class="action-btn confirm" bindtap="__e">开始诊断</view></view></view></block><block wx:if="{{diagnosisResult}}"><view class="result-area"><view class="result-header"><view class="result-title">诊断结果</view><view class="result-time">{{currentTime}}</view></view><view class="result-content"><view class="result-image-area"><image class="result-image" src="{{imageUrl}}" mode="aspectFill"></image></view><view class="result-detail"><block wx:for="{{diagnosisResult.items}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="result-item"><view class="item-name">{{item.name}}</view><view class="item-value">{{item.value}}</view></view></block><view class="result-analysis"><view class="analysis-title">分析说明</view><view class="analysis-text">{{diagnosisResult.analysis}}</view></view><view class="result-suggestion"><view class="suggestion-title">建议</view><view class="suggestion-text">{{diagnosisResult.suggestion}}</view></view></view></view><view class="result-actions"><view data-event-opts="{{[['tap',[['resetDiagnosis',['$event']]]]]}}" class="action-btn again" bindtap="__e">再次诊断</view><view data-event-opts="{{[['tap',[['saveDiagnosis',['$event']]]]]}}" class="action-btn save" bindtap="__e">保存结果</view></view></view></block><block wx:if="{{$root.g0}}"><view class="history-section"><view class="section-title"><text class="title">诊断历史</text><text data-event-opts="{{[['tap',[['viewAllHistory',['$event']]]]]}}" class="more" bindtap="__e">查看全部</text></view><view class="history-list"><block wx:for="{{diagnosisHistory}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['viewHistoryDetail',['$0'],[[['diagnosisHistory','',index]]]]]]]}}" class="history-item" bindtap="__e"><view class="history-type">{{item.type}}</view><image class="history-image" src="{{item.imageUrl}}" mode="aspectFill"></image><view class="history-info"><view class="info-main">{{item.mainResult}}</view><view class="info-time">{{item.time}}</view></view><text class="iconfont icon-right"></text></view></block></view></view></block></view>